<html>
  <head>
    <meta name="viewport" content="width=500, initial-scale=1">
    <title>parse.html</title>

    <!-- <script language="javascript" src="js/WebIDL2.js"></script> -->

    <script language="javascript" src="js/define.js"></script>
    <script language="javascript" src="js/stdlib.js"></script>
    <script language="javascript" src="js/parse.js"></script>
    <script language="javascript" src="js/w3cBNFParser.js"></script>
    <script language="javascript" src="js/webIDLParser.js"></script>
    <script language="javascript" src="js/webidl2.js"></script>

    <script language="javascript">
     var stdlib = require('stdlib');
     var webIDLParser = require('webIDLParser');
     var webidl2 = require('webidl2');
     console.log(webidl2);
     webIDLParser('/WebIDLStandard.bnf')(function(std) {
         console.log(std);
         webIDLParser('/WebIDLDraft.bnf')(function(draft) {
             console.log(draft);
             function tryParse(expect, path) {
                 var future = stdlib.future();
                 return stdlib.loadData(path)(function(str) {
                     debugger;
                     var res = {
                         expect: expect,
                         path: path,
                         str: str,
                         std: std.parseString(str),
                         draft: std.parseString(str),
                     };
                     try {
                         res.webidl2 = webidl2.parse(str);
                     } catch (err) {
                         res.webidl2 = err;
                     }
                     console.log(res);
                     future.set(res);
                 });
                 return future;
             }

             tryParse('pass', './foo.widl');

             /* tryParse('invalid', './test/invalid/idl/dict-required-default.widl');
              * tryParse('invalid', './test/invalid/idl/enum.widl');
              * tryParse('invalid', './test/invalid/idl/maplike-1type.widl');
              * tryParse('invalid', './test/invalid/idl/module.widl');
              * tryParse('invalid', './test/invalid/idl/nonnullableany.widl');
              * tryParse('invalid', './test/invalid/idl/nonnullableobjects.widl');
              * tryParse('invalid', './test/invalid/idl/raises.widl');
              * tryParse('invalid', './test/invalid/idl/readonly-iterable.widl');
              * tryParse('invalid', './test/invalid/idl/scopedname.widl');
              * tryParse('invalid', './test/invalid/idl/sequenceAsAttribute.widl');
              * tryParse('invalid', './test/invalid/idl/setlike-2types.widl');
              * tryParse('invalid', './test/invalid/idl/special-omittable.widl');
              * tryParse('invalid', './test/invalid/idl/typedef-nested.widl');*/

             /* tryParse('pass', './test/syntax/idl/allowany.widl');*/
             /* tryParse('pass', './test/syntax/idl/array.widl');
              * tryParse('pass', './test/syntax/idl/attributes.widl');
              * tryParse('pass', './test/syntax/idl/callback.widl');
              * tryParse('pass', './test/syntax/idl/caller.widl');
              * tryParse('pass', './test/syntax/idl/constants.widl');
              * tryParse('pass', './test/syntax/idl/constructor.widl');
              * tryParse('pass', './test/syntax/idl/dictionary-inherits.widl');
              * tryParse('pass', './test/syntax/idl/dictionary.widl');
              * tryParse('pass', './test/syntax/idl/documentation-dos.widl');
              * tryParse('pass', './test/syntax/idl/documentation.widl');
              * tryParse('pass', './test/syntax/idl/enum.widl');
              * tryParse('pass', './test/syntax/idl/equivalent-decl.widl');
              * tryParse('pass', './test/syntax/idl/exception-inheritance.widl');
              * tryParse('pass', './test/syntax/idl/exception.widl');
              * tryParse('pass', './test/syntax/idl/extended-attributes.widl');
              * tryParse('pass', './test/syntax/idl/generic.widl');
              * tryParse('pass', './test/syntax/idl/getter-setter.widl');
              * tryParse('pass', './test/syntax/idl/identifier-qualified-names.widl');
              * tryParse('pass', './test/syntax/idl/implements.widl');
              * tryParse('pass', './test/syntax/idl/indexed-properties.widl');
              * tryParse('pass', './test/syntax/idl/inherits-getter.widl');
              * tryParse('pass', './test/syntax/idl/interface-inherits.widl');
              * tryParse('pass', './test/syntax/idl/iterable.widl');
              * tryParse('pass', './test/syntax/idl/iterator.widl');
              * tryParse('pass', './test/syntax/idl/legacyiterable.widl');
              * tryParse('pass', './test/syntax/idl/map.widl');
              * tryParse('pass', './test/syntax/idl/maplike.widl');
              * tryParse('pass', './test/syntax/idl/namedconstructor.widl');
              * tryParse('pass', './test/syntax/idl/nointerfaceobject.widl');
              * tryParse('pass', './test/syntax/idl/nullable.widl');
              * tryParse('pass', './test/syntax/idl/nullableobjects.widl');
              * tryParse('pass', './test/syntax/idl/operation-optional-arg.widl');
              * tryParse('pass', './test/syntax/idl/overloading.widl');
              * tryParse('pass', './test/syntax/idl/overridebuiltins.widl');
              * tryParse('pass', './test/syntax/idl/partial-interface.widl');
              * tryParse('pass', './test/syntax/idl/primitives.widl');
              * tryParse('pass', './test/syntax/idl/prototyperoot.widl');
              * tryParse('pass', './test/syntax/idl/putforwards.widl');
              * tryParse('pass', './test/syntax/idl/reg-operations.widl');
              * tryParse('pass', './test/syntax/idl/replaceable.widl');
              * tryParse('pass', './test/syntax/idl/sequence.widl');
              * tryParse('pass', './test/syntax/idl/serializer.widl');
              * tryParse('pass', './test/syntax/idl/setlike.widl');
              * tryParse('pass', './test/syntax/idl/static.widl');
              * tryParse('pass', './test/syntax/idl/stringifier-attribute.widl');
              * tryParse('pass', './test/syntax/idl/stringifier-custom.widl');
              * tryParse('pass', './test/syntax/idl/stringifier.widl');
              * tryParse('pass', './test/syntax/idl/treatasnull.widl');
              * tryParse('pass', './test/syntax/idl/treatasundefined.widl');
              * tryParse('pass', './test/syntax/idl/typedef.widl');
              * tryParse('pass', './test/syntax/idl/typesuffixes.widl');
              * tryParse('pass', './test/syntax/idl/uniontype.widl');
              * tryParse('pass', './test/syntax/idl/variadic-operations.widl');*/
         });
     });
     try {
         console.log(webidl2.parse(`struct PP_DirEntry_Dev {
             str_t name;
             PP_Bool is_dir;
         };`));
     } catch (e) {
         console.log(e);
     }
    </script>
  </head>
  <body>
  </body>
</html>
